{
  "name": "sir",
  "description": "SIR model with birth and death processes, white noise on the transmission term and overdispersed binomial observation process",
  "keywords": ["SIR", "overdispersed binomial"],
  "licenses": [
    {
      "type": "cc0",
      "url": "http://creativecommons.org/publicdomain/zero/1.0/"
    }
  ],

  "version": "0.0.0",

  "models": [
    {
      "populations": [
        {"name": "paris", "composition": ["S", "I", "R"], "remainder": {"name": "R", "pop_size": "N"}},
      ],

      "reactions": [
        {"from": "U", "to": "S", "rate": "mu*N",     "description":"birth"},
        {"from": "S", "to": "I", "rate": "r0/N*v*I", "description":"infection", "keywords": ["transmission"], "tracked": ["Inc"], "white_noise": {"name": "noise_SI", "sd": "sto"}},
        {"from": "I", "to": "R", "rate": "v",        "description":"recovery"},
        {"from": "S", "to": "U", "rate": "mu",       "description":"death"},
        {"from": "I", "to": "U", "rate": "mu",       "description":"death"}
      ],

      "observations": [
        {
          "name": "Inc",
          "start": "2012-07-26",
          "distribution": "discretized_normal",
          "mean": "rep * prop * Inc",
          "sd": "sqrt(rep * ( 1.0 - rep ) * prop * Inc + ( rep * phi * prop * Inc )^2 )"
        }
      ],

      "data": [
        {
          "name": "Inc",
          "schema": {
            "fields": [
              {"foreignkey": {"resource": "data", "field": "date"}},
              {"foreignkey": {"resource": "data", "field": "Inc"}}
            ]
          }
        }
      ],

      "inputs": [
        {
          "name": "r0",
          "foreignkey": {"resource": "r0"}
        },
        {
          "name": "v",
          "description": "recovery rate",
          "foreignkey": {"resource":  "pr_v"},
          "transformation": "1/pr_v",
          "to_resource": "1/v"
        },
        {
          "name": "S",
          "description": "Number of susceptible",
          "foreignkey": {"resource": "pr_S"},
          "transformation": "pr_S*N",
          "to_resource": "S/N"
        },
        {
          "name": "I",
          "description": "Number of infectious",
          "foreignkey": {"resource": "pr_I"},
          "transformation": "10^-pr_I * N",
          "to_resource": "-log(I)/(log(10)*N)",
        },

        {
          "name": "rep",
          "foreignkey": {"resource": "rep"}
        },

        {
          "name": "phi",
          "foreignkey": {"resource": "phi"}
        },

        {
          "name": "N",
          "schema": {
            "fields": [
              {"foreignkey": {"resource": "covariates", "field": "date"}},
              {"foreignkey": {"resource": "covariates", "field": "N"}}
            ]
          }
        },
        {
          "name": "mu",
          "schema": {
            "fields": [
              {"foreignkey": {"resource": "covariates", "field": "date"}},
              {"foreignkey": {"resource": "covariates", "field": "mu"}}
            ]
          }
        },
        {
          "name": "prop",
          "schema": {
            "fields": [
              {"foreignkey": {"resource": "covariates", "field": "date"}},
              {"foreignkey": {"resource": "covariates", "field": "prop"}}
            ]
          }
        }
      ]
    }
  ],

  "resources": [
    {
      "name": "data",
      "path": "data/data.csv",
      "schema": {
        "fields": [
          {"name": "date", "type": "date"},
          {"name": "Inc", "type": "number"}
        ]
      }
    },

    {
      "name": "covariates",
      "path": "data/covariates.csv",
      "schema": {
        "fields": [
          {"name": "date", "type": "date"},
          {"name": "N", "type": "number"},
          {"name": "mu", "type": "number"},
          {"name": "prop", "type": "number"}
        ]
      }
    },

    {
      "name": "pr_S",
      "description": "Proportion of susceptible",
      "data": {
        "distribution": "uniform",
        "lower":0.04,
        "upper":0.09
      }
    },

    {
      "name": "pr_I",
      "description": "exponent (10^-x) to get a proportion of infectious",
      "data": {
        "distribution": "uniform",
        "lower": 4,
        "upper": 6
      }
    },

    {
      "name": "r0",
      "description": "basic reproduction number",
      "data": {
        "distribution": "uniform",
        "lower": 15.0,
        "upper": 35.0
      }
    },

    {
      "name": "pr_v",
      "description": "duration of infection",
      "data": {
        "distribution": "normal",
        "mean": 7.0,
        "sd": 2.0,
        "lower": 0.0,
        "unit": "day"
      }
    },

    {
      "name": "rep",
      "description": "reporting rate",
      "data": {
        "distribution": "uniform",
        "lower": 0.5,
        "upper": 0.8
      }
    },

    {
      "name": "phi",
      "description": "over-dispertion",
      "data": {
        "distribution": "fixed",
        "value": 0.1
      }
    },

    {
      "name": "values",
      "data": {
        "pr_S": 0.07,
        "pr_I": 5,
        "r0": 20.0,
        "pr_v": 11.0,
        "rep": 0.6
      }
    },

    {
      "name": "covariance",
      "data": {
        "pr_S": {"pr_S": 0.02},
        "pr_I": {"pr_I": 0.03},
        "r0": {"r0": 0.04, "pr_v": 0.01},       
        "pr_v": {"pr_v": 0.02},
        "rep": {"rep": 0.02}
      }
    }
  ]
}
